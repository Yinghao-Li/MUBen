<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>muben.layers - MUBen - Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "muben.layers";
        var mkdocs_page_input_path = "muben.layers.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> MUBen - Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">About MUBen</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="..">About</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../started/">Get Started</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">MUBen API</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../muben.args/">muben.args</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">muben.layers</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#class-outputlayer">class OutputLayer</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#function-__init__">function __init__</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#function-forward">function forward</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#function-initialize">function initialize</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../muben.dataset/">muben.dataset</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../muben.train/">muben.train</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../muben.utils/">muben.utils</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Examples</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../customize/">Customization</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">MUBen - Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">MUBen API</li>
      <li class="breadcrumb-item active">muben.layers</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <!-- markdownlint-disable -->

<h1 id="module-mubenlayers"><kbd>module</kbd> <code>muben.layers</code></h1>
<p>Versatile Output Layer for Backbone Models </p>
<p>This module implements an output layer that can be applied to various backbone models. It provides the option of utilizing different uncertainty  methods for model's output and supports both classification and regression tasks. </p>
<hr />
<h2 id="class-outputlayer"><kbd>class</kbd> <code>OutputLayer</code></h2>
<p>Customizable output layer for various backbone models. </p>
<p>This class provides an interface to add an output layer with or without uncertainty methods to various backbone models. It supports both classification and regression tasks and allows for the introduction of uncertainty into the model's output. </p>
<p><strong>Args:</strong></p>
<ul>
<li><b><code>last_hidden_dim</code></b> (int):  Dimensionality of the last hidden state from the backbone model. </li>
<li><b><code>n_output_heads</code></b> (int):  Number of output heads (e.g., number of classes for classification). </li>
<li><b><code>uncertainty_method</code></b> (str, optional):  Method to introduce uncertainty in the output layer.  Available methods are defined in UncertaintyMethods. Defaults to UncertaintyMethods.none. </li>
<li><b><code>task_type</code></b> (str, optional):  Type of task - "classification" or "regression". Defaults to "classification". </li>
<li><b><code>**kwargs</code></b>:  Additional keyword arguments to be passed to the specific output layers. </li>
</ul>
<p><strong>Attributes:</strong></p>
<ul>
<li><b><code>_uncertainty_method</code></b> (str):  The uncertainty method used in the output layer. </li>
<li><b><code>_task_type</code></b> (str):  The type of task the model is configured for (classification or regression). </li>
<li><b><code>output_layer</code></b> (nn.Module):  The specific output layer instance used in the model. </li>
<li><b><code>kld</code></b> (Optional[torch.Tensor]):  Kullback-Leibler Divergence for Bayesian methods, if applicable. </li>
</ul>
<h3 id="function-__init__"><kbd>function</kbd> <code>__init__</code></h3>
<pre><code class="language-python">__init__(
    last_hidden_dim,
    n_output_heads,
    uncertainty_method='none',
    task_type='classification',
    **kwargs
)
</code></pre>
<p>Initializes the OutputLayer instance. </p>
<p><strong>Args:</strong></p>
<ul>
<li><b><code>last_hidden_dim</code></b> (int):  Dimensionality of the last hidden state from the backbone model. </li>
<li><b><code>n_output_heads</code></b> (int):  Number of output heads (e.g., number of classes for classification). </li>
<li><b><code>uncertainty_method</code></b> (str, optional):  Method to introduce uncertainty in the output layer.  Available methods are defined in UncertaintyMethods. Defaults to UncertaintyMethods.none. </li>
<li><b><code>task_type</code></b> (str, optional):  Type of task - "classification" or "regression". Defaults to "classification". </li>
<li><b><code>**kwargs</code></b>:  Additional keyword arguments to be passed to the specific output layers. </li>
</ul>
<hr />
<h3 id="function-forward"><kbd>function</kbd> <code>forward</code></h3>
<pre><code class="language-python">forward(x: Tensor, **kwargs) → Tensor
</code></pre>
<p>Forward pass of the output layer. </p>
<p><strong>Args:</strong></p>
<ul>
<li><b><code>x</code></b> (torch.Tensor):  Input tensor for the output layer. </li>
</ul>
<p><strong>Returns:</strong></p>
<ul>
<li><b><code>torch.Tensor</code></b>:  The output logits or values of the model. </li>
</ul>
<hr />
<h3 id="function-initialize"><kbd>function</kbd> <code>initialize</code></h3>
<pre><code class="language-python">initialize() → OutputLayer
</code></pre>
<p>Initializes the weights of the output layer. </p>
<p>Different initializations are applied based on the uncertainty method and task type. </p>
<p><strong>Returns:</strong></p>
<ul>
<li><b><code>OutputLayer</code></b>:  The initialized model instance. </li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../muben.args/" class="btn btn-neutral float-left" title="muben.args"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../muben.dataset/" class="btn btn-neutral float-right" title="muben.dataset">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../muben.args/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../muben.dataset/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
